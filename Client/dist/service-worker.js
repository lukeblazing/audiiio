const CACHE_NAME="app-cache-v1",urlsToCache=["/","/index.html","/main.js"];self.addEventListener("install",(e=>{e.waitUntil(caches.open(CACHE_NAME).then((e=>e.addAll(urlsToCache))).then((()=>self.skipWaiting())).catch((e=>console.error("Failed to cache assets during install:",e))))})),self.addEventListener("fetch",(e=>{"GET"===e.request.method?e.respondWith(caches.match(e.request).then((t=>t||fetch(e.request))).catch((t=>(console.error("Fetch error:",t),fetch(e.request))))):e.respondWith(fetch(e.request))})),self.addEventListener("activate",(e=>{e.waitUntil(caches.keys().then((e=>Promise.all(e.filter((e=>e!==CACHE_NAME)).map((e=>caches.delete(e)))))).then((()=>self.clients.claim())).catch((e=>console.error("Activation error:",e))))})),self.addEventListener("push",(e=>{let t={};if(e.data)try{t=e.data.json()}catch(n){t={body:e.data.text()}}const n=t.title||"New Notification",i={body:t.body||"You have a new message!",icon:t.icon||"/icon.png",badge:t.badge||"/badge.png",data:{url:t.url||"/"}};e.waitUntil(self.registration.showNotification(n,i))})),self.addEventListener("notificationclick",(e=>{e.notification.close(),e.waitUntil(clients.matchAll({type:"window",includeUncontrolled:!0}).then((t=>{for(const n of t)if(n.url===e.notification.data.url&&"focus"in n)return n.focus();if(clients.openWindow)return clients.openWindow(e.notification.data.url)})))}));